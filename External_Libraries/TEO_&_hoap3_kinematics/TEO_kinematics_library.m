function h = TEO_kinematics_library ()
h.w_T_RF = @w_T_RF;
h.w_J_RF = @w_J_RF;
h.RF_T_w = @RF_T_w;
h.RF_J_w = @RF_J_w;
h.w_T_LF = @w_T_LF;
h.w_J_LF = @w_J_LF;
h.LF_T_w = @LF_T_w;
h.LF_J_w = @LF_J_w;
h.w_T_CoM = @w_T_CoM;
h.w_J_CoM = @w_J_CoM;
h.CoM_T_RH = @CoM_T_RH;
h.CoM_J_RH = @CoM_J_RH;
h.CoM_T_LH = @CoM_T_LH;
h.CoM_J_LH = @CoM_J_LH;
h.RF_T_CoM = @RF_T_CoM;
h.RF_J_CoM = @RF_J_CoM;
h.LF_T_CoM = @LF_T_CoM;
h.LF_J_CoM = @LF_J_CoM;
h.CoM_T_RF = @CoM_T_RF;
h.CoM_T_LF = @CoM_T_LF;
end
function pose = w_T_RF (q)
pose=[	- (33.*cos(q(2,:)).*sin(q(1,:)))./1000 - (33.*cos(q(1,:)).*sin(q(3,:)))./100 - (3.*cos(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))))./10 - (3.*sin(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:))))./10 - (31.*cos(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))))))./250 - (33.*cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:)))./100 - (31.*cos(q(2,:)).*sin(q(1,:)).*sin(q(6,:)))./250;
		(33.*cos(q(1,:)).*cos(q(2,:)))./1000 - (33.*sin(q(1,:)).*sin(q(3,:)))./100 - (3.*cos(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))))./10 - (3.*sin(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:))))./10 - (31.*cos(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))))))./250 + (33.*cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:)))./100 + (31.*cos(q(1,:)).*cos(q(2,:)).*sin(q(6,:)))./250 - 73./500;
		(33.*sin(q(2,:)))./1000 - (33.*cos(q(2,:)).*cos(q(3,:)))./100 + (31.*sin(q(2,:)).*sin(q(6,:)))./250 + (3.*cos(q(2,:)).*sin(q(3,:)).*sin(q(4,:)))./10 - (31.*cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)))./250 - (3.*cos(q(2,:)).*cos(q(3,:)).*cos(q(4,:)))./10;
		(cos(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:)))) - sin(q(2,:)).*sin(q(6,:)) - sin(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))))) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)) + cos(q(1,:)).*cos(q(2,:)).*cos(q(6,:)) + 1).^(1./2)./2;
		1./2.*sign(cos(q(6,:)).*sin(q(2,:)) - cos(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))))) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:)) + cos(q(1,:)).*cos(q(2,:)).*sin(q(6,:))).*(cos(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:)))) + sin(q(2,:)).*sin(q(6,:)) - sin(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) - sin(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))))) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)) - cos(q(1,:)).*cos(q(2,:)).*cos(q(6,:)) + 1).^(1./2);
		1./2.*sign(sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)) + cos(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))))) + cos(q(2,:)).*sin(q(1,:)).*sin(q(6,:))).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))))) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)) + cos(q(1,:)).*cos(q(2,:)).*cos(q(6,:)) + 1).^(1./2);
		1./2.*sign(cos(q(5,:)).*(cos(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:)))) - sin(q(5,:)).*(cos(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) - sin(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))))) + cos(q(2,:)).*cos(q(6,:)).*sin(q(1,:))).*(sin(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) - sin(q(2,:)).*sin(q(6,:)) - cos(q(5,:)).*(cos(q(4,:)).*(cos(q(1,:)).*cos(q(3,:)) - sin(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(cos(q(1,:)).*sin(q(3,:)) + cos(q(3,:)).*sin(q(1,:)).*sin(q(2,:)))) - sin(q(6,:)).*(cos(q(5,:)).*(cos(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))) + sin(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:)))) + sin(q(5,:)).*(cos(q(4,:)).*(cos(q(3,:)).*sin(q(1,:)) + cos(q(1,:)).*sin(q(2,:)).*sin(q(3,:))) - sin(q(4,:)).*(sin(q(1,:)).*sin(q(3,:)) - cos(q(1,:)).*cos(q(3,:)).*sin(q(2,:))))) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)) - cos(q(1,:)).*cos(q(2,:)).*cos(q(6,:)) + 1).^(1./2)];
end
function M = w_J_RF(in1)
%W_J_RF
%    M = W_J_RF(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:00

theta01 = in1(1,:);
theta02 = in1(2,:);
theta03 = in1(3,:);
theta04 = in1(4,:);
theta05 = in1(5,:);
theta06 = in1(6,:);
t2 = sin(theta01);
t3 = sin(theta03);
t4 = cos(theta01);
t5 = cos(theta03);
t6 = sin(theta02);
t7 = cos(theta04);
t8 = t2.*t3;
t14 = t4.*t5.*t6;
t9 = t8-t14;
t10 = sin(theta04);
t11 = t2.*t5;
t12 = t3.*t4.*t6;
t13 = t11+t12;
t15 = cos(theta02);
t16 = sin(theta06);
t17 = cos(theta06);
t18 = t2.*t3.*(3.3e1./1.0e2);
t19 = t7.*t9.*(3.0./1.0e1);
t20 = t10.*t13.*(3.0./1.0e1);
t21 = cos(theta05);
t22 = t7.*t9;
t23 = t10.*t13;
t24 = t22+t23;
t25 = sin(theta05);
t26 = t9.*t10;
t39 = t7.*t13;
t27 = t26-t39;
t38 = t21.*t24;
t40 = t25.*t27;
t28 = t38-t40;
t29 = t17.*t28.*(3.1e1./2.5e2);
t37 = t4.*t15.*(3.3e1./1.0e3);
t41 = t4.*t15.*t16.*(3.1e1./2.5e2);
t30 = t18+t19+t20+t29-t37-t41-t4.*t5.*t6.*(3.3e1./1.0e2);
t31 = t6.*(3.3e1./1.0e3);
t32 = t6.*t16.*(3.1e1./2.5e2);
t33 = t3.*t10.*t15.*(3.0./1.0e1);
t34 = theta03+theta04+theta05;
t35 = cos(t34);
t42 = t15.*t17.*t35.*(3.1e1./2.5e2);
t43 = t5.*t7.*t15.*(3.0./1.0e1);
t52 = t5.*t15.*(3.3e1./1.0e2);
t36 = t31+t32+t33-t42-t43-t52;
t44 = t32-t42;
t45 = t29-t41;
t46 = t3.*t4;
t47 = t2.*t5.*t6;
t48 = t46+t47;
t49 = t4.*t5;
t51 = t2.*t3.*t6;
t50 = t49-t51;
t53 = t7.*t48;
t54 = t10.*t50;
t55 = t53+t54;
t56 = t21.*t55;
t57 = t7.*t50;
t64 = t10.*t48;
t58 = t57-t64;
t59 = t25.*t58;
t60 = t56+t59;
t61 = t2.*t15.*(3.3e1./1.0e3);
t62 = t7.*t48.*(3.0./1.0e1);
t63 = t10.*t50.*(3.0./1.0e1);
t65 = t17.*t60.*(3.1e1./2.5e2);
t66 = t2.*t15.*t16.*(3.1e1./2.5e2);
t67 = t31+t32+t33-t42-t43;
t68 = sin(t34);
t69 = t65+t66;
t70 = t5.*t10.*t15.*(3.0./1.0e1);
t71 = t3.*t7.*t15.*(3.0./1.0e1);
t72 = t5.*t7.*t15.*t17.*t25.*(3.1e1./2.5e2);
t73 = t5.*t10.*t15.*t17.*t21.*(3.1e1./2.5e2);
t74 = t3.*t7.*t15.*t17.*t21.*(3.1e1./2.5e2);
t75 = t21.*t58;
t76 = t75-t25.*t55;
t77 = t4.*t15;
t78 = t21.*t27;
t79 = t24.*t25;
M = reshape([t30,t3.*t4.*(-3.3e1./1.0e2)-t2.*t15.*(3.3e1./1.0e3)-t7.*t48.*(3.0./1.0e1)-t10.*t50.*(3.0./1.0e1)-t17.*t60.*(3.1e1./2.5e2)-t2.*t5.*t6.*(3.3e1./1.0e2)-t2.*t15.*t16.*(3.1e1./2.5e2),0.0,0.0,0.0,1.0,t2.*t36,-t4.*t36,t15.*(3.3e1./1.0e3)+t5.*t6.*(3.3e1./1.0e2)+t15.*t16.*(3.1e1./2.5e2)+t5.*t6.*t7.*(3.0./1.0e1)-t3.*t6.*t10.*(3.0./1.0e1)+t5.*t6.*t7.*t17.*t21.*(3.1e1./2.5e2)-t3.*t6.*t10.*t17.*t21.*(3.1e1./2.5e2)-t3.*t6.*t7.*t17.*t25.*(3.1e1./2.5e2)-t5.*t6.*t10.*t17.*t25.*(3.1e1./2.5e2),t4,t2,0.0,t6.*t30+t4.*t15.*t36,-t6.*(t61+t62+t63+t65+t66+t3.*t4.*(3.3e1./1.0e2)+t2.*t5.*t6.*(3.3e1./1.0e2))+t2.*t15.*t36,t70+t71+t72+t73+t74+t3.*t15.*(3.3e1./1.0e2)-t3.*t10.*t15.*t17.*t25.*(3.1e1./2.5e2),-t2.*t15,t77,t6,t6.*(t19+t20+t29-t37-t41)+t4.*t15.*t67,-t6.*(t61+t62+t63+t65+t66)+t2.*t15.*t67,t70+t71+t72+t73+t74-t3.*t10.*t15.*t17.*t25.*(3.1e1./2.5e2),-t2.*t15,t77,t6,t6.*t45+t4.*t15.*t44,-t6.*t69+t2.*t15.*t44,t15.*t17.*(t3.*t7.*t21+t5.*t10.*t21+t5.*t7.*t25-t3.*t10.*t25).*(3.1e1./2.5e2),-t2.*t15,t77,t6,-t44.*(t78+t79)-t15.*t45.*t68,-t44.*t76+t15.*t68.*t69,t6.*t17.*(3.1e1./2.5e2)+t5.*t7.*t15.*t16.*t21.*(3.1e1./2.5e2)-t3.*t10.*t15.*t16.*t21.*(3.1e1./2.5e2)-t3.*t7.*t15.*t16.*t25.*(3.1e1./2.5e2)-t5.*t10.*t15.*t16.*t25.*(3.1e1./2.5e2),t76,-t78-t79,-t15.*t68],[6, 6]);

end
function pose = RF_T_w (q)
pose=[	(73.*cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)))./500 - (3.*sin(q(5,:)))./10 - (33.*sin(q(4,:) + q(5,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:)))./500;
		(3.*cos(q(5,:)).*sin(q(6,:)))./10 - (33.*cos(q(6,:)))./1000 + (73.*cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))))./500 - (33.*sin(q(4,:)).*sin(q(5,:)).*sin(q(6,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))./500 + (33.*cos(q(4,:)).*cos(q(5,:)).*sin(q(6,:)))./100;
		(33.*sin(q(6,:)))./1000 + (3.*cos(q(5,:)).*cos(q(6,:)))./10 - (73.*cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))))./500 - (33.*cos(q(6,:)).*sin(q(4,:)).*sin(q(5,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))./500 + (33.*cos(q(4,:)).*cos(q(5,:)).*cos(q(6,:)))./100 + 31./250;
		(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(2,:)).*sin(q(6,:)) + cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)) + 1).^(1./2)./2;
		1./2.*sign(sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)) - cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:)) - cos(q(6,:)).*sin(q(2,:))).*(sin(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)) + 1).^(1./2);
		1./2.*sign(- sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) + cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)) + 1).^(1./2);
		1./2.*sign(sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:)) - sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:)))).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(2,:)).*sin(q(6,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)) + 1).^(1./2)];
end
function M = RF_J_w(in1)
%RF_J_W
%    M = RF_J_W(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:04

theta01 = in1(1,:);
theta02 = in1(2,:);
theta03 = in1(3,:);
theta04 = in1(4,:);
theta05 = in1(5,:);
theta06 = in1(6,:);
t2 = theta03+theta04+theta05;
t3 = sin(t2);
t4 = cos(theta01);
t5 = sin(theta01);
t6 = cos(t2);
t7 = sin(theta02);
t8 = t4.*t6.*t7.*(7.3e1./5.0e2);
t9 = cos(theta05);
t10 = cos(theta04);
t11 = sin(theta04);
t12 = sin(theta05);
t13 = t11.*t12.*(3.3e1./1.0e2);
t14 = cos(theta02);
t15 = sin(theta06);
t16 = cos(theta06);
t17 = t5.*t6.*(7.3e1./5.0e2);
t18 = t3.*t4.*t7.*(7.3e1./5.0e2);
t19 = theta04+theta05;
t20 = sin(t19);
t21 = t17+t18;
t22 = t20.*(3.3e1./1.0e2);
t23 = t12.*(3.0./1.0e1);
t24 = t7.*t16;
t25 = t6.*t14.*t15;
t26 = t7.*t15;
t27 = t26-t6.*t14.*t16;
M = reshape([t4.*t6.*(7.3e1./5.0e2)-t3.*t5.*t7.*(7.3e1./5.0e2),t3.*t4.*t15.*(7.3e1./5.0e2)-t5.*t14.*t16.*(7.3e1./5.0e2)+t5.*t6.*t7.*t15.*(7.3e1./5.0e2),t3.*t4.*t16.*(7.3e1./5.0e2)+t5.*t14.*t15.*(7.3e1./5.0e2)+t5.*t6.*t7.*t16.*(7.3e1./5.0e2),t3.*t14,-t24-t25,t27,t3.*t4.*t14.*(7.3e1./5.0e2),t4.*(t24+t25).*(-7.3e1./5.0e2),t4.*t27.*(7.3e1./5.0e2),-t6,-t3.*t15,-t3.*t16,t8-t3.*t5.*(7.3e1./5.0e2),t15.*t21,t16.*t21,0.0,-t16,t15,t8+t13-t3.*t5.*(7.3e1./5.0e2)-t9.*t10.*(3.3e1./1.0e2),t15.*(t17+t18-t20.*(3.3e1./1.0e2)),t16.*(t17+t18-t22),0.0,-t16,t15,t8-t9.*(3.0./1.0e1)+t13-t3.*t5.*(7.3e1./5.0e2)-t9.*t10.*(3.3e1./1.0e2),t15.*(t17+t18-t22-t23),t16.*(t17+t18-t22-t23),0.0,-t16,t15,0.0,t15.*(3.3e1./1.0e3)-t4.*(t14.*t15+t6.*t7.*t16).*(7.3e1./5.0e2)+t9.*t16.*(3.0./1.0e1)+t3.*t5.*t16.*(7.3e1./5.0e2)+t9.*t10.*t16.*(3.3e1./1.0e2)-t11.*t12.*t16.*(3.3e1./1.0e2),t16.*(3.3e1./1.0e3)-t4.*(t14.*t16-t6.*t7.*t15).*(7.3e1./5.0e2)-t9.*t15.*(3.0./1.0e1)-t3.*t5.*t15.*(7.3e1./5.0e2)-t9.*t10.*t15.*(3.3e1./1.0e2)+t11.*t12.*t15.*(3.3e1./1.0e2),-1.0,0.0,0.0],[6, 6]);

end
function pose = w_T_LF (q)
pose=[	(33.*cos(q(8,:)).*sin(q(7,:)))./1000 - (33.*cos(q(7,:)).*sin(q(9,:)))./100 - (3.*cos(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))))./10 - (3.*sin(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:))))./10 - (31.*cos(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))))))./250 - (33.*cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:)))./100 - (31.*cos(q(8,:)).*sin(q(7,:)).*sin(q(12,:)))./250;
		(33.*cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:)))./100 - (33.*sin(q(7,:)).*sin(q(9,:)))./100 - (3.*cos(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))))./10 - (3.*sin(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:))))./10 - (31.*cos(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))))))./250 - (33.*cos(q(7,:)).*cos(q(8,:)))./1000 + (31.*cos(q(7,:)).*cos(q(8,:)).*sin(q(12,:)))./250 + 73./500;
		(31.*sin(q(8,:)).*sin(q(12,:)))./250 - (33.*cos(q(8,:)).*cos(q(9,:)))./100 - (33.*sin(q(8,:)))./1000 + (3.*cos(q(8,:)).*sin(q(9,:)).*sin(q(10,:)))./10 - (31.*cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)))./250 - (3.*cos(q(8,:)).*cos(q(9,:)).*cos(q(10,:)))./10;
		(cos(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:)))) - sin(q(8,:)).*sin(q(12,:)) - sin(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))))) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)) + cos(q(7,:)).*cos(q(8,:)).*cos(q(12,:)) + 1).^(1./2)./2;
		1./2.*sign(cos(q(12,:)).*sin(q(8,:)) - cos(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))))) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:)) + cos(q(7,:)).*cos(q(8,:)).*sin(q(12,:))).*(cos(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:)))) + sin(q(8,:)).*sin(q(12,:)) - sin(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) - sin(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))))) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)) - cos(q(7,:)).*cos(q(8,:)).*cos(q(12,:)) + 1).^(1./2);
		1./2.*sign(sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)) + cos(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))))) + cos(q(8,:)).*sin(q(7,:)).*sin(q(12,:))).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))))) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)) + cos(q(7,:)).*cos(q(8,:)).*cos(q(12,:)) + 1).^(1./2);
		1./2.*sign(cos(q(11,:)).*(cos(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:)))) - sin(q(11,:)).*(cos(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) - sin(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))))) + cos(q(8,:)).*cos(q(12,:)).*sin(q(7,:))).*(sin(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) - sin(q(8,:)).*sin(q(12,:)) - cos(q(11,:)).*(cos(q(10,:)).*(cos(q(7,:)).*cos(q(9,:)) - sin(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(cos(q(7,:)).*sin(q(9,:)) + cos(q(9,:)).*sin(q(7,:)).*sin(q(8,:)))) - sin(q(12,:)).*(cos(q(11,:)).*(cos(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))) + sin(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:)))) + sin(q(11,:)).*(cos(q(10,:)).*(cos(q(9,:)).*sin(q(7,:)) + cos(q(7,:)).*sin(q(8,:)).*sin(q(9,:))) - sin(q(10,:)).*(sin(q(7,:)).*sin(q(9,:)) - cos(q(7,:)).*cos(q(9,:)).*sin(q(8,:))))) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)) - cos(q(7,:)).*cos(q(8,:)).*cos(q(12,:)) + 1).^(1./2)];
end
function M = w_J_LF(in1)
%W_J_LF
%    M = W_J_LF(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:12

theta07 = in1(7,:);
theta08 = in1(8,:);
theta09 = in1(9,:);
theta10 = in1(10,:);
theta11 = in1(11,:);
theta12 = in1(12,:);
t2 = sin(theta07);
t3 = sin(theta09);
t4 = cos(theta07);
t5 = cos(theta09);
t6 = sin(theta08);
t7 = cos(theta10);
t8 = t2.*t3;
t14 = t4.*t5.*t6;
t9 = t8-t14;
t10 = sin(theta10);
t11 = t2.*t5;
t12 = t3.*t4.*t6;
t13 = t11+t12;
t15 = cos(theta08);
t16 = sin(theta12);
t17 = cos(theta12);
t18 = t4.*t15.*(3.3e1./1.0e3);
t19 = t2.*t3.*(3.3e1./1.0e2);
t20 = t7.*t9.*(3.0./1.0e1);
t21 = t10.*t13.*(3.0./1.0e1);
t22 = cos(theta11);
t23 = t7.*t9;
t24 = t10.*t13;
t25 = t23+t24;
t26 = sin(theta11);
t27 = t9.*t10;
t40 = t7.*t13;
t28 = t27-t40;
t39 = t22.*t25;
t41 = t26.*t28;
t29 = t39-t41;
t30 = t17.*t29.*(3.1e1./2.5e2);
t42 = t4.*t15.*t16.*(3.1e1./2.5e2);
t31 = t18+t19+t20+t21+t30-t42-t4.*t5.*t6.*(3.3e1./1.0e2);
t32 = t6.*(3.3e1./1.0e3);
t33 = t5.*t15.*(3.3e1./1.0e2);
t34 = theta09+theta10+theta11;
t35 = cos(t34);
t36 = t15.*t17.*t35.*(3.1e1./2.5e2);
t37 = t5.*t7.*t15.*(3.0./1.0e1);
t43 = t6.*t16.*(3.1e1./2.5e2);
t44 = t3.*t10.*t15.*(3.0./1.0e1);
t38 = t32+t33+t36+t37-t43-t44;
t45 = t30-t42;
t46 = t3.*t4;
t47 = t2.*t5.*t6;
t48 = t46+t47;
t49 = t4.*t5;
t51 = t2.*t3.*t6;
t50 = t49-t51;
t52 = t2.*t15.*(3.3e1./1.0e3);
t53 = t7.*t48;
t54 = t10.*t50;
t55 = t53+t54;
t56 = t22.*t55;
t57 = t7.*t50;
t63 = t10.*t48;
t58 = t57-t63;
t59 = t26.*t58;
t60 = t56+t59;
t61 = t7.*t48.*(3.0./1.0e1);
t62 = t10.*t50.*(3.0./1.0e1);
t64 = t17.*t60.*(3.1e1./2.5e2);
t65 = t2.*t15.*t16.*(3.1e1./2.5e2);
t66 = t32+t36+t37-t43-t44;
t67 = t36-t43;
t68 = sin(t34);
t69 = t64+t65;
t70 = t5.*t10.*t15.*(3.0./1.0e1);
t71 = t3.*t7.*t15.*(3.0./1.0e1);
t72 = t5.*t7.*t15.*t17.*t26.*(3.1e1./2.5e2);
t73 = t5.*t10.*t15.*t17.*t22.*(3.1e1./2.5e2);
t74 = t3.*t7.*t15.*t17.*t22.*(3.1e1./2.5e2);
t75 = t22.*t58;
t76 = t75-t26.*t55;
t77 = t4.*t15;
t78 = t22.*t28;
t79 = t25.*t26;
M = reshape([t31,t52-t3.*t4.*(3.3e1./1.0e2)-t7.*t48.*(3.0./1.0e1)-t10.*t50.*(3.0./1.0e1)-t17.*t60.*(3.1e1./2.5e2)-t2.*t5.*t6.*(3.3e1./1.0e2)-t2.*t15.*t16.*(3.1e1./2.5e2),0.0,0.0,0.0,1.0,-t2.*t38,t4.*t38,t15.*(-3.3e1./1.0e3)+t5.*t6.*(3.3e1./1.0e2)+t15.*t16.*(3.1e1./2.5e2)+t5.*t6.*t7.*(3.0./1.0e1)-t3.*t6.*t10.*(3.0./1.0e1)+t5.*t6.*t7.*t17.*t22.*(3.1e1./2.5e2)-t3.*t6.*t10.*t17.*t22.*(3.1e1./2.5e2)-t3.*t6.*t7.*t17.*t26.*(3.1e1./2.5e2)-t5.*t6.*t10.*t17.*t26.*(3.1e1./2.5e2),t4,t2,0.0,t6.*t31-t4.*t15.*t38,-t6.*(-t52+t61+t62+t64+t65+t3.*t4.*(3.3e1./1.0e2)+t2.*t5.*t6.*(3.3e1./1.0e2))-t2.*t15.*t38,t70+t71+t72+t73+t74+t3.*t15.*(3.3e1./1.0e2)-t3.*t10.*t15.*t17.*t26.*(3.1e1./2.5e2),-t2.*t15,t77,t6,t6.*(t18+t20+t21+t30-t42)-t4.*t15.*t66,-t6.*(-t52+t61+t62+t64+t65)-t2.*t15.*t66,t70+t71+t72+t73+t74-t3.*t10.*t15.*t17.*t26.*(3.1e1./2.5e2),-t2.*t15,t77,t6,t6.*t45-t4.*t15.*t67,-t6.*t69-t2.*t15.*t67,t15.*t17.*(t3.*t7.*t22+t5.*t10.*t22+t5.*t7.*t26-t3.*t10.*t26).*(3.1e1./2.5e2),-t2.*t15,t77,t6,t67.*(t78+t79)-t15.*t45.*t68,t76.*(t36-t43)+t15.*t68.*t69,t6.*t17.*(3.1e1./2.5e2)+t5.*t7.*t15.*t16.*t22.*(3.1e1./2.5e2)-t3.*t10.*t15.*t16.*t22.*(3.1e1./2.5e2)-t3.*t7.*t15.*t16.*t26.*(3.1e1./2.5e2)-t5.*t10.*t15.*t16.*t26.*(3.1e1./2.5e2),t76,-t78-t79,-t15.*t68],[6, 6]);

end
function pose = LF_T_w (q)
pose=[	- (33.*sin(q(10,:) + q(11,:)))./100 - (3.*sin(q(11,:)))./10 - (73.*cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)))./500 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:)))./500;
		(33.*cos(q(12,:)))./1000 + (3.*cos(q(11,:)).*sin(q(12,:)))./10 - (73.*cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))))./500 - (33.*sin(q(10,:)).*sin(q(11,:)).*sin(q(12,:)))./100 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))./500 + (33.*cos(q(10,:)).*cos(q(11,:)).*sin(q(12,:)))./100;
		(3.*cos(q(11,:)).*cos(q(12,:)))./10 - (33.*sin(q(12,:)))./1000 + (73.*cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))))./500 - (33.*cos(q(12,:)).*sin(q(10,:)).*sin(q(11,:)))./100 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))./500 + (33.*cos(q(10,:)).*cos(q(11,:)).*cos(q(12,:)))./100 + 31./250;
		(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(8,:)).*sin(q(12,:)) + cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)) + 1).^(1./2)./2;
		1./2.*sign(sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)) - cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:)) - cos(q(12,:)).*sin(q(8,:))).*(sin(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)) + 1).^(1./2);
		1./2.*sign(- sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) + cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)) + 1).^(1./2);
		1./2.*sign(sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:)) - sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:)))).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(8,:)).*sin(q(12,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)) + 1).^(1./2)];
end
function M = LF_J_w(in1)
%LF_J_W
%    M = LF_J_W(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:14

theta07 = in1(7,:);
theta08 = in1(8,:);
theta09 = in1(9,:);
theta10 = in1(10,:);
theta11 = in1(11,:);
theta12 = in1(12,:);
t2 = theta09+theta10+theta11;
t3 = sin(t2);
t4 = cos(theta07);
t5 = sin(theta07);
t6 = cos(t2);
t7 = sin(theta08);
t8 = t3.*t5.*(7.3e1./5.0e2);
t9 = cos(theta11);
t10 = cos(theta10);
t11 = sin(theta10);
t12 = sin(theta11);
t13 = t11.*t12.*(3.3e1./1.0e2);
t14 = cos(theta08);
t15 = sin(theta12);
t16 = cos(theta12);
t17 = t5.*t6.*(7.3e1./5.0e2);
t18 = t3.*t4.*t7.*(7.3e1./5.0e2);
t19 = theta10+theta11;
t20 = sin(t19);
t21 = t20.*(3.3e1./1.0e2);
t22 = t17+t18;
t23 = t17+t18+t21;
t24 = t12.*(3.0./1.0e1);
t25 = t17+t18+t21+t24;
t26 = t7.*t16;
t27 = t6.*t14.*t15;
t28 = t7.*t15;
t29 = t28-t6.*t14.*t16;
M = reshape([t4.*t6.*(-7.3e1./5.0e2)+t3.*t5.*t7.*(7.3e1./5.0e2),t3.*t4.*t15.*(-7.3e1./5.0e2)+t5.*t14.*t16.*(7.3e1./5.0e2)-t5.*t6.*t7.*t15.*(7.3e1./5.0e2),t3.*t4.*t16.*(-7.3e1./5.0e2)-t5.*t14.*t15.*(7.3e1./5.0e2)-t5.*t6.*t7.*t16.*(7.3e1./5.0e2),t3.*t14,-t26-t27,t29,t3.*t4.*t14.*(-7.3e1./5.0e2),t4.*(t26+t27).*(7.3e1./5.0e2),t4.*t29.*(-7.3e1./5.0e2),-t6,-t3.*t15,-t3.*t16,t8-t4.*t6.*t7.*(7.3e1./5.0e2),-t15.*t22,-t16.*t22,0.0,-t16,t15,t8+t13-t9.*t10.*(3.3e1./1.0e2)-t4.*t6.*t7.*(7.3e1./5.0e2),-t15.*t23,-t16.*t23,0.0,-t16,t15,t8-t9.*(3.0./1.0e1)+t13-t9.*t10.*(3.3e1./1.0e2)-t4.*t6.*t7.*(7.3e1./5.0e2),-t15.*t25,-t16.*t25,0.0,-t16,t15,0.0,t15.*(-3.3e1./1.0e3)+t4.*(t14.*t15+t6.*t7.*t16).*(7.3e1./5.0e2)+t9.*t16.*(3.0./1.0e1)-t3.*t5.*t16.*(7.3e1./5.0e2)+t9.*t10.*t16.*(3.3e1./1.0e2)-t11.*t12.*t16.*(3.3e1./1.0e2),t16.*(-3.3e1./1.0e3)+t4.*(t14.*t16-t6.*t7.*t15).*(7.3e1./5.0e2)-t9.*t15.*(3.0./1.0e1)+t3.*t5.*t15.*(7.3e1./5.0e2)-t9.*t10.*t15.*(3.3e1./1.0e2)+t11.*t12.*t15.*(3.3e1./1.0e2),-1.0,0.0,0.0],[6, 6]);

end
function pose = w_T_CoM (q)
pose=[	(3.*cos(q(13,:)).*sin(q(14,:)))./50;
		(3.*sin(q(13,:)).*sin(q(14,:)))./50;
		(3.*cos(q(14,:)))./50 + 287./1000;
		(cos(q(13,:)) + cos(q(14,:)) + cos(q(13,:)).*cos(q(14,:)) + 1).^(1./2)./2;
		1./2.*sign(-sin(q(13,:)).*sin(q(14,:))).*(cos(q(13,:)).*cos(q(14,:)) - cos(q(14,:)) - cos(q(13,:)) + 1).^(1./2);
		1./2.*sign(sin(q(14,:)) + cos(q(13,:)).*sin(q(14,:))).*(cos(q(13,:)) - cos(q(14,:)) - cos(q(13,:)).*cos(q(14,:)) + 1).^(1./2);
		1./2.*sign(sin(q(13,:)) + cos(q(14,:)).*sin(q(13,:))).*(cos(q(14,:)) - cos(q(13,:)) - cos(q(13,:)).*cos(q(14,:)) + 1).^(1./2)];
end
function M = w_J_CoM(in1)
%W_J_COM
%    M = W_J_COM(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:15

theta13 = in1(13,:);
M = reshape([0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,-sin(theta13),cos(theta13),0.0],[6, 2]);

end
function pose = CoM_T_RH (q)
pose=[	- (337.*cos(q(16,:)).*sin(q(15,:)))./1000 - (21.*sin(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))))./100 - (21.*cos(q(16,:)).*cos(q(18,:)).*sin(q(15,:)))./100;
		(337.*sin(q(16,:)))./1000 + (21.*cos(q(18,:)).*sin(q(16,:)))./100 - (21.*cos(q(16,:)).*sin(q(17,:)).*sin(q(18,:)))./100 - 17./50;
		(21.*sin(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))))./100 - (337.*cos(q(15,:)).*cos(q(16,:)))./1000 - (21.*cos(q(15,:)).*cos(q(16,:)).*cos(q(18,:)))./100 + 49./200;
		(cos(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(16,:)).*sin(q(15,:)).*sin(q(18,:))) - sin(q(19,:)).*(cos(q(15,:)).*sin(q(17,:)) - cos(q(17,:)).*sin(q(15,:)).*sin(q(16,:)))) - sin(q(20,:)).*(sin(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(18,:)).*sin(q(15,:))) - sin(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(15,:)).*cos(q(16,:)).*sin(q(18,:))) - sin(q(19,:)).*(sin(q(15,:)).*sin(q(17,:)) + cos(q(15,:)).*cos(q(17,:)).*sin(q(16,:)))) - cos(q(20,:)).*(sin(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(15,:)).*cos(q(16,:)).*cos(q(18,:))) - sin(q(19,:)).*(sin(q(16,:)).*sin(q(18,:)) + cos(q(16,:)).*cos(q(18,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(17,:)).*cos(q(19,:)) + 1).^(1./2)./2;
		1./2.*sign(sin(q(19,:)).*(cos(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(15,:)).*cos(q(16,:)).*sin(q(18,:))) - sin(q(20,:)).*(cos(q(19,:)).*(sin(q(16,:)).*sin(q(18,:)) + cos(q(16,:)).*cos(q(18,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(17,:)).*sin(q(19,:))) + cos(q(19,:)).*(sin(q(15,:)).*sin(q(17,:)) + cos(q(15,:)).*cos(q(17,:)).*sin(q(16,:))) + cos(q(20,:)).*(cos(q(18,:)).*sin(q(16,:)) - cos(q(16,:)).*sin(q(17,:)).*sin(q(18,:)))).*(cos(q(20,:)).*(sin(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(15,:)).*cos(q(16,:)).*cos(q(18,:))) - sin(q(20,:)).*(sin(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(18,:)).*sin(q(15,:))) + sin(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(15,:)).*cos(q(16,:)).*sin(q(18,:))) - sin(q(19,:)).*(sin(q(15,:)).*sin(q(17,:)) + cos(q(15,:)).*cos(q(17,:)).*sin(q(16,:)))) + cos(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(16,:)).*sin(q(15,:)).*sin(q(18,:))) - sin(q(19,:)).*(cos(q(15,:)).*sin(q(17,:)) - cos(q(17,:)).*sin(q(15,:)).*sin(q(16,:)))) + sin(q(19,:)).*(sin(q(16,:)).*sin(q(18,:)) + cos(q(16,:)).*cos(q(18,:)).*sin(q(17,:))) - cos(q(16,:)).*cos(q(17,:)).*cos(q(19,:)) + 1).^(1./2);
		1./2.*sign(cos(q(20,:)).*(sin(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(18,:)).*sin(q(15,:))) - sin(q(20,:)).*(sin(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(15,:)).*cos(q(16,:)).*cos(q(18,:))) + cos(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(15,:)).*cos(q(16,:)).*sin(q(18,:))) - sin(q(19,:)).*(sin(q(15,:)).*sin(q(17,:)) + cos(q(15,:)).*cos(q(17,:)).*sin(q(16,:)))) + sin(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(16,:)).*sin(q(15,:)).*sin(q(18,:))) - sin(q(19,:)).*(cos(q(15,:)).*sin(q(17,:)) - cos(q(17,:)).*sin(q(15,:)).*sin(q(16,:))))).*(cos(q(20,:)).*(sin(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(15,:)).*cos(q(16,:)).*cos(q(18,:))) + sin(q(20,:)).*(sin(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(18,:)).*sin(q(15,:))) + sin(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(15,:)).*cos(q(16,:)).*sin(q(18,:))) - sin(q(19,:)).*(sin(q(15,:)).*sin(q(17,:)) + cos(q(15,:)).*cos(q(17,:)).*sin(q(16,:)))) - cos(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(16,:)).*sin(q(15,:)).*sin(q(18,:))) - sin(q(19,:)).*(cos(q(15,:)).*sin(q(17,:)) - cos(q(17,:)).*sin(q(15,:)).*sin(q(16,:)))) - sin(q(19,:)).*(sin(q(16,:)).*sin(q(18,:)) + cos(q(16,:)).*cos(q(18,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(17,:)).*cos(q(19,:)) + 1).^(1./2);
		1./2.*sign(cos(q(20,:)).*(cos(q(19,:)).*(sin(q(16,:)).*sin(q(18,:)) + cos(q(16,:)).*cos(q(18,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(17,:)).*sin(q(19,:))) + sin(q(19,:)).*(cos(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(16,:)).*sin(q(15,:)).*sin(q(18,:))) + cos(q(19,:)).*(cos(q(15,:)).*sin(q(17,:)) - cos(q(17,:)).*sin(q(15,:)).*sin(q(16,:))) + sin(q(20,:)).*(cos(q(18,:)).*sin(q(16,:)) - cos(q(16,:)).*sin(q(17,:)).*sin(q(18,:)))).*(sin(q(20,:)).*(sin(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(16,:)).*cos(q(18,:)).*sin(q(15,:))) - cos(q(20,:)).*(sin(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(15,:)).*cos(q(16,:)).*cos(q(18,:))) - sin(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(17,:)).*sin(q(15,:)) - cos(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) + cos(q(15,:)).*cos(q(16,:)).*sin(q(18,:))) - sin(q(19,:)).*(sin(q(15,:)).*sin(q(17,:)) + cos(q(15,:)).*cos(q(17,:)).*sin(q(16,:)))) - cos(q(20,:)).*(cos(q(19,:)).*(cos(q(18,:)).*(cos(q(15,:)).*cos(q(17,:)) + sin(q(15,:)).*sin(q(16,:)).*sin(q(17,:))) - cos(q(16,:)).*sin(q(15,:)).*sin(q(18,:))) - sin(q(19,:)).*(cos(q(15,:)).*sin(q(17,:)) - cos(q(17,:)).*sin(q(15,:)).*sin(q(16,:)))) + sin(q(19,:)).*(sin(q(16,:)).*sin(q(18,:)) + cos(q(16,:)).*cos(q(18,:)).*sin(q(17,:))) - cos(q(16,:)).*cos(q(17,:)).*cos(q(19,:)) + 1).^(1./2)];
end
function M = CoM_J_RH(in1)
%COM_J_RH
%    M = COM_J_RH(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:16

theta15 = in1(15,:);
theta16 = in1(16,:);
theta17 = in1(17,:);
theta18 = in1(18,:);
theta19 = in1(19,:);
t2 = cos(theta15);
t3 = cos(theta16);
t4 = sin(theta15);
t5 = sin(theta16);
t6 = cos(theta18);
t7 = sin(theta17);
t8 = sin(theta18);
t9 = cos(theta17);
t10 = t5.*(3.37e2./1.0e3);
t11 = t5.*t6.*(2.1e1./1.0e2);
t12 = t10+t11-t3.*t7.*t8.*(2.1e1./1.0e2);
t13 = t2.*t7;
t14 = t2.*t9;
t15 = t4.*t5.*t7;
t16 = t14+t15;
t17 = t4.*t5.*t9;
t18 = sin(theta19);
t19 = cos(theta19);
t20 = t4.*t7;
t21 = t2.*t5.*t9;
t22 = t20+t21;
t23 = t4.*t9;
t25 = t2.*t5.*t7;
t24 = t23-t25;
M = reshape([t2.*t3.*(-3.37e2./1.0e3)+t8.*t24.*(2.1e1./1.0e2)-t2.*t3.*t6.*(2.1e1./1.0e2),0.0,t3.*t4.*(3.37e2./1.0e3)+t8.*t16.*(2.1e1./1.0e2)+t3.*t4.*t6.*(2.1e1./1.0e2),0.0,1.0,0.0,t4.*t12,t3.*(3.37e2./1.0e3)+t3.*t6.*(2.1e1./1.0e2)+t5.*t7.*t8.*(2.1e1./1.0e2),t2.*t12,t2,0.0,-t4,t8.*(t13-t4.*t5.*t9).*(2.1e1./1.0e2),t3.*t8.*t9.*(-2.1e1./1.0e2),t8.*t22.*(-2.1e1./1.0e2),t3.*t4,-t5,t2.*t3,t3.*t4.*t8.*(2.1e1./1.0e2)-t2.*t6.*t9.*(2.1e1./1.0e2)-t4.*t5.*t6.*t7.*(2.1e1./1.0e2),t5.*t8.*(-2.1e1./1.0e2)-t3.*t6.*t7.*(2.1e1./1.0e2),t2.*t3.*t8.*(2.1e1./1.0e2)+t4.*t6.*t9.*(2.1e1./1.0e2)-t2.*t5.*t6.*t7.*(2.1e1./1.0e2),-t13+t17,t3.*t9,t22,0.0,0.0,0.0,t8.*t16+t3.*t4.*t6,-t5.*t6+t3.*t7.*t8,-t8.*t24+t2.*t3.*t6,0.0,0.0,0.0,-t18.*(t6.*t16-t3.*t4.*t8)-t19.*(t13-t17),-t18.*(t5.*t8+t3.*t6.*t7)+t3.*t9.*t19,t18.*(t6.*t24+t2.*t3.*t8)+t19.*t22],[6, 6]);

end
function pose = CoM_T_LH (q)
pose=[	- (337.*cos(q(22,:)).*sin(q(21,:)))./1000 - (21.*sin(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))))./100 - (21.*cos(q(22,:)).*cos(q(24,:)).*sin(q(21,:)))./100;
		(337.*sin(q(22,:)))./1000 + (21.*cos(q(24,:)).*sin(q(22,:)))./100 - (21.*cos(q(22,:)).*sin(q(23,:)).*sin(q(24,:)))./100 + 17./50;
		(21.*sin(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))))./100 - (337.*cos(q(21,:)).*cos(q(22,:)))./1000 - (21.*cos(q(21,:)).*cos(q(22,:)).*cos(q(24,:)))./100 + 49./200;
		(cos(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(22,:)).*sin(q(21,:)).*sin(q(24,:))) - sin(q(25,:)).*(cos(q(21,:)).*sin(q(23,:)) - cos(q(23,:)).*sin(q(21,:)).*sin(q(22,:)))) - sin(q(26,:)).*(sin(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(24,:)).*sin(q(21,:))) - sin(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(21,:)).*cos(q(22,:)).*sin(q(24,:))) - sin(q(25,:)).*(sin(q(21,:)).*sin(q(23,:)) + cos(q(21,:)).*cos(q(23,:)).*sin(q(22,:)))) - cos(q(26,:)).*(sin(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(21,:)).*cos(q(22,:)).*cos(q(24,:))) - sin(q(25,:)).*(sin(q(22,:)).*sin(q(24,:)) + cos(q(22,:)).*cos(q(24,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(23,:)).*cos(q(25,:)) + 1).^(1./2)./2;
		1./2.*sign(sin(q(25,:)).*(cos(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(21,:)).*cos(q(22,:)).*sin(q(24,:))) - sin(q(26,:)).*(cos(q(25,:)).*(sin(q(22,:)).*sin(q(24,:)) + cos(q(22,:)).*cos(q(24,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(23,:)).*sin(q(25,:))) + cos(q(25,:)).*(sin(q(21,:)).*sin(q(23,:)) + cos(q(21,:)).*cos(q(23,:)).*sin(q(22,:))) + cos(q(26,:)).*(cos(q(24,:)).*sin(q(22,:)) - cos(q(22,:)).*sin(q(23,:)).*sin(q(24,:)))).*(cos(q(26,:)).*(sin(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(21,:)).*cos(q(22,:)).*cos(q(24,:))) - sin(q(26,:)).*(sin(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(24,:)).*sin(q(21,:))) + sin(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(21,:)).*cos(q(22,:)).*sin(q(24,:))) - sin(q(25,:)).*(sin(q(21,:)).*sin(q(23,:)) + cos(q(21,:)).*cos(q(23,:)).*sin(q(22,:)))) + cos(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(22,:)).*sin(q(21,:)).*sin(q(24,:))) - sin(q(25,:)).*(cos(q(21,:)).*sin(q(23,:)) - cos(q(23,:)).*sin(q(21,:)).*sin(q(22,:)))) + sin(q(25,:)).*(sin(q(22,:)).*sin(q(24,:)) + cos(q(22,:)).*cos(q(24,:)).*sin(q(23,:))) - cos(q(22,:)).*cos(q(23,:)).*cos(q(25,:)) + 1).^(1./2);
		1./2.*sign(cos(q(26,:)).*(sin(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(24,:)).*sin(q(21,:))) - sin(q(26,:)).*(sin(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(21,:)).*cos(q(22,:)).*cos(q(24,:))) + cos(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(21,:)).*cos(q(22,:)).*sin(q(24,:))) - sin(q(25,:)).*(sin(q(21,:)).*sin(q(23,:)) + cos(q(21,:)).*cos(q(23,:)).*sin(q(22,:)))) + sin(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(22,:)).*sin(q(21,:)).*sin(q(24,:))) - sin(q(25,:)).*(cos(q(21,:)).*sin(q(23,:)) - cos(q(23,:)).*sin(q(21,:)).*sin(q(22,:))))).*(cos(q(26,:)).*(sin(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(21,:)).*cos(q(22,:)).*cos(q(24,:))) + sin(q(26,:)).*(sin(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(24,:)).*sin(q(21,:))) + sin(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(21,:)).*cos(q(22,:)).*sin(q(24,:))) - sin(q(25,:)).*(sin(q(21,:)).*sin(q(23,:)) + cos(q(21,:)).*cos(q(23,:)).*sin(q(22,:)))) - cos(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(22,:)).*sin(q(21,:)).*sin(q(24,:))) - sin(q(25,:)).*(cos(q(21,:)).*sin(q(23,:)) - cos(q(23,:)).*sin(q(21,:)).*sin(q(22,:)))) - sin(q(25,:)).*(sin(q(22,:)).*sin(q(24,:)) + cos(q(22,:)).*cos(q(24,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(23,:)).*cos(q(25,:)) + 1).^(1./2);
		1./2.*sign(cos(q(26,:)).*(cos(q(25,:)).*(sin(q(22,:)).*sin(q(24,:)) + cos(q(22,:)).*cos(q(24,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(23,:)).*sin(q(25,:))) + sin(q(25,:)).*(cos(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(22,:)).*sin(q(21,:)).*sin(q(24,:))) + cos(q(25,:)).*(cos(q(21,:)).*sin(q(23,:)) - cos(q(23,:)).*sin(q(21,:)).*sin(q(22,:))) + sin(q(26,:)).*(cos(q(24,:)).*sin(q(22,:)) - cos(q(22,:)).*sin(q(23,:)).*sin(q(24,:)))).*(sin(q(26,:)).*(sin(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(22,:)).*cos(q(24,:)).*sin(q(21,:))) - cos(q(26,:)).*(sin(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(21,:)).*cos(q(22,:)).*cos(q(24,:))) - sin(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(23,:)).*sin(q(21,:)) - cos(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) + cos(q(21,:)).*cos(q(22,:)).*sin(q(24,:))) - sin(q(25,:)).*(sin(q(21,:)).*sin(q(23,:)) + cos(q(21,:)).*cos(q(23,:)).*sin(q(22,:)))) - cos(q(26,:)).*(cos(q(25,:)).*(cos(q(24,:)).*(cos(q(21,:)).*cos(q(23,:)) + sin(q(21,:)).*sin(q(22,:)).*sin(q(23,:))) - cos(q(22,:)).*sin(q(21,:)).*sin(q(24,:))) - sin(q(25,:)).*(cos(q(21,:)).*sin(q(23,:)) - cos(q(23,:)).*sin(q(21,:)).*sin(q(22,:)))) + sin(q(25,:)).*(sin(q(22,:)).*sin(q(24,:)) + cos(q(22,:)).*cos(q(24,:)).*sin(q(23,:))) - cos(q(22,:)).*cos(q(23,:)).*cos(q(25,:)) + 1).^(1./2)];
end
function M = CoM_J_LH(in1)
%COM_J_LH
%    M = COM_J_LH(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:17

theta21 = in1(21,:);
theta22 = in1(22,:);
theta23 = in1(23,:);
theta24 = in1(24,:);
theta25 = in1(25,:);
t2 = cos(theta21);
t3 = cos(theta22);
t4 = sin(theta21);
t5 = sin(theta22);
t6 = cos(theta24);
t7 = sin(theta23);
t8 = sin(theta24);
t9 = cos(theta23);
t10 = t5.*(3.37e2./1.0e3);
t11 = t5.*t6.*(2.1e1./1.0e2);
t12 = t10+t11-t3.*t7.*t8.*(2.1e1./1.0e2);
t13 = t2.*t7;
t14 = t2.*t9;
t15 = t4.*t5.*t7;
t16 = t14+t15;
t17 = t4.*t5.*t9;
t18 = sin(theta25);
t19 = cos(theta25);
t20 = t4.*t7;
t21 = t2.*t5.*t9;
t22 = t20+t21;
t23 = t4.*t9;
t25 = t2.*t5.*t7;
t24 = t23-t25;
M = reshape([t2.*t3.*(-3.37e2./1.0e3)+t8.*t24.*(2.1e1./1.0e2)-t2.*t3.*t6.*(2.1e1./1.0e2),0.0,t3.*t4.*(3.37e2./1.0e3)+t8.*t16.*(2.1e1./1.0e2)+t3.*t4.*t6.*(2.1e1./1.0e2),0.0,1.0,0.0,t4.*t12,t3.*(3.37e2./1.0e3)+t3.*t6.*(2.1e1./1.0e2)+t5.*t7.*t8.*(2.1e1./1.0e2),t2.*t12,t2,0.0,-t4,t8.*(t13-t4.*t5.*t9).*(2.1e1./1.0e2),t3.*t8.*t9.*(-2.1e1./1.0e2),t8.*t22.*(-2.1e1./1.0e2),t3.*t4,-t5,t2.*t3,t3.*t4.*t8.*(2.1e1./1.0e2)-t2.*t6.*t9.*(2.1e1./1.0e2)-t4.*t5.*t6.*t7.*(2.1e1./1.0e2),t5.*t8.*(-2.1e1./1.0e2)-t3.*t6.*t7.*(2.1e1./1.0e2),t2.*t3.*t8.*(2.1e1./1.0e2)+t4.*t6.*t9.*(2.1e1./1.0e2)-t2.*t5.*t6.*t7.*(2.1e1./1.0e2),-t13+t17,t3.*t9,t22,0.0,0.0,0.0,t8.*t16+t3.*t4.*t6,-t5.*t6+t3.*t7.*t8,-t8.*t24+t2.*t3.*t6,0.0,0.0,0.0,-t18.*(t6.*t16-t3.*t4.*t8)-t19.*(t13-t17),-t18.*(t5.*t8+t3.*t6.*t7)+t3.*t9.*t19,t18.*(t6.*t24+t2.*t3.*t8)+t19.*t22],[6, 6]);

end
function pose = RF_T_CoM (q)
pose=[	(73.*cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)))./500 - (3.*sin(q(5,:)))./10 - (33.*sin(q(4,:) + q(5,:)))./100 + (3.*cos(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))))./50 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:)))./500 - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*((3.*cos(q(14,:)))./50 + 287./1000);
		(3.*cos(q(5,:)).*sin(q(6,:)))./10 - (33.*cos(q(6,:)))./1000 + ((3.*cos(q(14,:)))./50 + 287./1000).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) + (73.*cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))))./500 - (33.*sin(q(4,:)).*sin(q(5,:)).*sin(q(6,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))))./50 + (33.*cos(q(4,:)).*cos(q(5,:)).*sin(q(6,:)))./100;
		(33.*sin(q(6,:)))./1000 + (3.*cos(q(5,:)).*cos(q(6,:)))./10 - ((3.*cos(q(14,:)))./50 + 287./1000).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - (73.*cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))))./500 - (33.*cos(q(6,:)).*sin(q(4,:)).*sin(q(5,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))./500 + (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))))./50 - (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))))./50 + (33.*cos(q(4,:)).*cos(q(5,:)).*cos(q(6,:)))./100 + 31./250;
		(cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) - cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) + sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) + cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:)) + cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + 1).^(1./2)./2;
		1./2.*sign(cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) - sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) - cos(q(14,:)).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) - cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))).*(cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) - sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) + cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:)) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + 1).^(1./2);
		1./2.*sign(cos(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) - sin(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(14,:)) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) - cos(q(13,:)).*cos(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))).*(cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) + cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) + sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) - cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:)) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + 1).^(1./2);
		1./2.*sign(sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) - cos(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) - sin(q(14,:)).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) - cos(q(13,:)).*cos(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))).*(cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) - cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) - cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:)) - cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + 1).^(1./2)];
end
function M = RF_J_CoM(in1)
%RF_J_COM
%    M = RF_J_COM(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:21

theta01 = in1(1,:);
theta02 = in1(2,:);
theta03 = in1(3,:);
theta04 = in1(4,:);
theta05 = in1(5,:);
theta06 = in1(6,:);
theta13 = in1(13,:);
t2 = theta03+theta04+theta05;
t3 = sin(t2);
t4 = cos(theta01);
t5 = sin(theta01);
t6 = cos(t2);
t7 = sin(theta02);
t8 = t4.*t6.*t7.*(7.3e1./5.0e2);
t9 = cos(theta05);
t10 = cos(theta04);
t11 = sin(theta04);
t12 = sin(theta05);
t13 = t11.*t12.*(3.3e1./1.0e2);
t14 = cos(theta02);
t15 = sin(theta06);
t16 = cos(theta06);
t17 = t5.*t6.*(7.3e1./5.0e2);
t18 = t3.*t4.*t7.*(7.3e1./5.0e2);
t19 = theta04+theta05;
t20 = sin(t19);
t21 = t17+t18;
t22 = t20.*(3.3e1./1.0e2);
t23 = t12.*(3.0./1.0e1);
t24 = t7.*t16;
t25 = t6.*t14.*t15;
t26 = t7.*t15;
t27 = t26-t6.*t14.*t16;
M = reshape([t4.*t6.*(7.3e1./5.0e2)-t3.*t5.*t7.*(7.3e1./5.0e2),t3.*t4.*t15.*(7.3e1./5.0e2)-t5.*t14.*t16.*(7.3e1./5.0e2)+t5.*t6.*t7.*t15.*(7.3e1./5.0e2),t3.*t4.*t16.*(7.3e1./5.0e2)+t5.*t14.*t15.*(7.3e1./5.0e2)+t5.*t6.*t7.*t16.*(7.3e1./5.0e2),t3.*t14,-t24-t25,t27,t3.*t4.*t14.*(7.3e1./5.0e2),t4.*(t24+t25).*(-7.3e1./5.0e2),t4.*t27.*(7.3e1./5.0e2),-t6,-t3.*t15,-t3.*t16,t8-t3.*t5.*(7.3e1./5.0e2),t15.*t21,t16.*t21,0.0,-t16,t15,t8+t13-t3.*t5.*(7.3e1./5.0e2)-t9.*t10.*(3.3e1./1.0e2),t15.*(t17+t18-t20.*(3.3e1./1.0e2)),t16.*(t17+t18-t22),0.0,-t16,t15,t8-t9.*(3.0./1.0e1)+t13-t3.*t5.*(7.3e1./5.0e2)-t9.*t10.*(3.3e1./1.0e2),t15.*(t17+t18-t22-t23),t16.*(t17+t18-t22-t23),0.0,-t16,t15,0.0,t15.*(3.3e1./1.0e3)-t4.*(t14.*t15+t6.*t7.*t16).*(7.3e1./5.0e2)+t9.*t16.*(3.0./1.0e1)+t3.*t5.*t16.*(7.3e1./5.0e2)+t9.*t10.*t16.*(3.3e1./1.0e2)-t11.*t12.*t16.*(3.3e1./1.0e2),t16.*(3.3e1./1.0e3)-t4.*(t14.*t16-t6.*t7.*t15).*(7.3e1./5.0e2)-t9.*t15.*(3.0./1.0e1)-t3.*t5.*t15.*(7.3e1./5.0e2)-t9.*t10.*t15.*(3.3e1./1.0e2)+t11.*t12.*t15.*(3.3e1./1.0e2),-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,-sin(theta13),cos(theta13),0.0],[6, 8]);

end
function pose = LF_T_CoM (q)
pose=[	(3.*cos(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))))./50 - (3.*sin(q(11,:)))./10 - (73.*cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)))./500 - (33.*sin(q(10,:) + q(11,:)))./100 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))))./50 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:)))./500 - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*((3.*cos(q(14,:)))./50 + 287./1000);
		(33.*cos(q(12,:)))./1000 + (3.*cos(q(11,:)).*sin(q(12,:)))./10 + ((3.*cos(q(14,:)))./50 + 287./1000).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) - (73.*cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))))./500 - (33.*sin(q(10,:)).*sin(q(11,:)).*sin(q(12,:)))./100 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))))./50 + (33.*cos(q(10,:)).*cos(q(11,:)).*sin(q(12,:)))./100;
		(3.*cos(q(11,:)).*cos(q(12,:)))./10 - (33.*sin(q(12,:)))./1000 - ((3.*cos(q(14,:)))./50 + 287./1000).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) + (73.*cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))))./500 - (33.*cos(q(12,:)).*sin(q(10,:)).*sin(q(11,:)))./100 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))./500 + (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))))./50 - (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))))./50 + (33.*cos(q(10,:)).*cos(q(11,:)).*cos(q(12,:)))./100 + 31./250;
		(cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) - cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) + sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) + cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:)) + cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + 1).^(1./2)./2;
		1./2.*sign(cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) - sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) - cos(q(14,:)).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) - cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))).*(cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) - sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) + cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:)) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + 1).^(1./2);
		1./2.*sign(cos(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) - sin(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(14,:)) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) - cos(q(13,:)).*cos(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))).*(cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) + cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) + sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) - cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:)) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + 1).^(1./2);
		1./2.*sign(sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) - cos(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) - sin(q(14,:)).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) - cos(q(13,:)).*cos(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))).*(cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) - cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) - cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:)) - cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + 1).^(1./2)];
end
function M = LF_J_CoM(in1)
%LF_J_COM
%    M = LF_J_COM(IN1)

%    This function was generated by the Symbolic Math Toolbox version 5.8.
%    07-Aug-2013 22:38:23

theta07 = in1(7,:);
theta08 = in1(8,:);
theta09 = in1(9,:);
theta10 = in1(10,:);
theta11 = in1(11,:);
theta12 = in1(12,:);
theta13 = in1(13,:);
t2 = theta09+theta10+theta11;
t3 = sin(t2);
t4 = cos(theta07);
t5 = sin(theta07);
t6 = cos(t2);
t7 = sin(theta08);
t8 = t3.*t5.*(7.3e1./5.0e2);
t9 = cos(theta11);
t10 = cos(theta10);
t11 = sin(theta10);
t12 = sin(theta11);
t13 = t11.*t12.*(3.3e1./1.0e2);
t14 = cos(theta08);
t15 = sin(theta12);
t16 = cos(theta12);
t17 = t5.*t6.*(7.3e1./5.0e2);
t18 = t3.*t4.*t7.*(7.3e1./5.0e2);
t19 = theta10+theta11;
t20 = sin(t19);
t21 = t20.*(3.3e1./1.0e2);
t22 = t17+t18;
t23 = t17+t18+t21;
t24 = t12.*(3.0./1.0e1);
t25 = t17+t18+t21+t24;
t26 = t7.*t16;
t27 = t6.*t14.*t15;
t28 = t7.*t15;
t29 = t28-t6.*t14.*t16;
M = reshape([t4.*t6.*(-7.3e1./5.0e2)+t3.*t5.*t7.*(7.3e1./5.0e2),t3.*t4.*t15.*(-7.3e1./5.0e2)+t5.*t14.*t16.*(7.3e1./5.0e2)-t5.*t6.*t7.*t15.*(7.3e1./5.0e2),t3.*t4.*t16.*(-7.3e1./5.0e2)-t5.*t14.*t15.*(7.3e1./5.0e2)-t5.*t6.*t7.*t16.*(7.3e1./5.0e2),t3.*t14,-t26-t27,t29,t3.*t4.*t14.*(-7.3e1./5.0e2),t4.*(t26+t27).*(7.3e1./5.0e2),t4.*t29.*(-7.3e1./5.0e2),-t6,-t3.*t15,-t3.*t16,t8-t4.*t6.*t7.*(7.3e1./5.0e2),-t15.*t22,-t16.*t22,0.0,-t16,t15,t8+t13-t9.*t10.*(3.3e1./1.0e2)-t4.*t6.*t7.*(7.3e1./5.0e2),-t15.*t23,-t16.*t23,0.0,-t16,t15,t8-t9.*(3.0./1.0e1)+t13-t9.*t10.*(3.3e1./1.0e2)-t4.*t6.*t7.*(7.3e1./5.0e2),-t15.*t25,-t16.*t25,0.0,-t16,t15,0.0,t15.*(-3.3e1./1.0e3)+t4.*(t14.*t15+t6.*t7.*t16).*(7.3e1./5.0e2)+t9.*t16.*(3.0./1.0e1)-t3.*t5.*t16.*(7.3e1./5.0e2)+t9.*t10.*t16.*(3.3e1./1.0e2)-t11.*t12.*t16.*(3.3e1./1.0e2),t16.*(-3.3e1./1.0e3)+t4.*(t14.*t16-t6.*t7.*t15).*(7.3e1./5.0e2)-t9.*t15.*(3.0./1.0e1)+t3.*t5.*t15.*(7.3e1./5.0e2)-t9.*t10.*t15.*(3.3e1./1.0e2)+t11.*t12.*t15.*(3.3e1./1.0e2),-1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,-sin(theta13),cos(theta13),0.0],[6, 8]);

end
function pose = CoM_T_RF (q)
pose=[	(sin(q(14,:)).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) + cos(q(13,:)).*cos(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))).*((3.*cos(q(5,:)).*sin(q(6,:)))./10 - (33.*cos(q(6,:)))./1000 + ((3.*cos(q(14,:)))./50 + 287./1000).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) + (73.*cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))))./500 - (33.*sin(q(4,:)).*sin(q(5,:)).*sin(q(6,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))))./50 + (33.*cos(q(4,:)).*cos(q(5,:)).*sin(q(6,:)))./100) - (sin(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) + cos(q(13,:)).*cos(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))).*((33.*sin(q(6,:)))./1000 + (3.*cos(q(5,:)).*cos(q(6,:)))./10 - ((3.*cos(q(14,:)))./50 + 287./1000).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - (73.*cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))))./500 - (33.*cos(q(6,:)).*sin(q(4,:)).*sin(q(5,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))./500 + (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))))./50 - (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))))./50 + (33.*cos(q(4,:)).*cos(q(5,:)).*cos(q(6,:)))./100 + 31./250) - (cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:))).*((73.*cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)))./500 - (3.*sin(q(5,:)))./10 - (33.*sin(q(4,:) + q(5,:)))./100 + (3.*cos(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))))./50 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:)))./500 - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*((3.*cos(q(14,:)))./50 + 287./1000));
		(cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:)))).*((33.*sin(q(6,:)))./1000 + (3.*cos(q(5,:)).*cos(q(6,:)))./10 - ((3.*cos(q(14,:)))./50 + 287./1000).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - (73.*cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))))./500 - (33.*cos(q(6,:)).*sin(q(4,:)).*sin(q(5,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))./500 + (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))))./50 - (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))))./50 + (33.*cos(q(4,:)).*cos(q(5,:)).*cos(q(6,:)))./100 + 31./250) - (cos(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) - sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:)))).*((73.*cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)))./500 - (3.*sin(q(5,:)))./10 - (33.*sin(q(4,:) + q(5,:)))./100 + (3.*cos(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))))./50 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:)))./500 - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*((3.*cos(q(14,:)))./50 + 287./1000)) - (cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) + sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:)))).*((3.*cos(q(5,:)).*sin(q(6,:)))./10 - (33.*cos(q(6,:)))./1000 + ((3.*cos(q(14,:)))./50 + 287./1000).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) + (73.*cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))))./500 - (33.*sin(q(4,:)).*sin(q(5,:)).*sin(q(6,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))))./50 + (33.*cos(q(4,:)).*cos(q(5,:)).*sin(q(6,:)))./100);
		(cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))).*((33.*sin(q(6,:)))./1000 + (3.*cos(q(5,:)).*cos(q(6,:)))./10 - ((3.*cos(q(14,:)))./50 + 287./1000).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - (73.*cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))))./500 - (33.*cos(q(6,:)).*sin(q(4,:)).*sin(q(5,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))./500 + (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))))./50 - (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))))./50 + (33.*cos(q(4,:)).*cos(q(5,:)).*cos(q(6,:)))./100 + 31./250) - (cos(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(14,:)) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:)))).*((73.*cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)))./500 - (3.*sin(q(5,:)))./10 - (33.*sin(q(4,:) + q(5,:)))./100 + (3.*cos(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))))./50 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:)))./500 - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*((3.*cos(q(14,:)))./50 + 287./1000)) - (cos(q(14,:)).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))).*((3.*cos(q(5,:)).*sin(q(6,:)))./10 - (33.*cos(q(6,:)))./1000 + ((3.*cos(q(14,:)))./50 + 287./1000).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) + (73.*cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))))./500 - (33.*sin(q(4,:)).*sin(q(5,:)).*sin(q(6,:)))./100 + (73.*sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))))./50 + (33.*cos(q(4,:)).*cos(q(5,:)).*sin(q(6,:)))./100);
		(cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) - cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) + sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) + cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:)) + cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + 1).^(1./2)./2;
		1./2.*sign(cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) + cos(q(14,:)).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))).*(cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) - sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) + cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:)) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + 1).^(1./2);
		1./2.*sign(sin(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - cos(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(14,:)) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) + cos(q(13,:)).*cos(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:)))).*(cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) + cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) + sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) - cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:)) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + 1).^(1./2);
		1./2.*sign(sin(q(14,:)).*(cos(q(6,:)).*sin(q(2,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(6,:))) + cos(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) - sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) + cos(q(13,:)).*cos(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:)))).*(cos(q(13,:)).*sin(q(14,:)).*(sin(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*cos(q(6,:))) - cos(q(14,:)).*(sin(q(2,:)).*sin(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*cos(q(6,:))) - sin(q(13,:)).*(sin(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(6,:))) - cos(q(13,:)).*cos(q(14,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)) - sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(2,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)) + sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(1,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(2,:)).*sin(q(14,:)) - cos(q(13,:)).*(cos(q(1,:)).*(cos(q(2,:)).*cos(q(6,:)) - cos(q(3,:) + q(4,:) + q(5,:)).*sin(q(2,:)).*sin(q(6,:))) + sin(q(3,:) + q(4,:) + q(5,:)).*sin(q(1,:)).*sin(q(6,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(1,:)).*(cos(q(2,:)).*sin(q(6,:)) + cos(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(2,:))) - sin(q(3,:) + q(4,:) + q(5,:)).*cos(q(6,:)).*sin(q(1,:))) + 1).^(1./2)];
end
function pose = CoM_T_LF (q)
pose=[	(cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:))).*((33.*sin(q(10,:) + q(11,:)))./100 + (3.*sin(q(11,:)))./10 + (73.*cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))))./50 - (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))))./50 + (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:)))./500 + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*((3.*cos(q(14,:)))./50 + 287./1000)) + (sin(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) + cos(q(13,:)).*cos(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))).*((33.*sin(q(12,:)))./1000 - (3.*cos(q(11,:)).*cos(q(12,:)))./10 + ((3.*cos(q(14,:)))./50 + 287./1000).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - (73.*cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))))./500 + (33.*cos(q(12,:)).*sin(q(10,:)).*sin(q(11,:)))./100 + (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))))./50 - (33.*cos(q(10,:)).*cos(q(11,:)).*cos(q(12,:)))./100 - 31./250) + (sin(q(14,:)).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) + cos(q(13,:)).*cos(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))).*((33.*cos(q(12,:)))./1000 + (3.*cos(q(11,:)).*sin(q(12,:)))./10 + ((3.*cos(q(14,:)))./50 + 287./1000).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) - (73.*cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))))./500 - (33.*sin(q(10,:)).*sin(q(11,:)).*sin(q(12,:)))./100 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))))./50 + (33.*cos(q(10,:)).*cos(q(11,:)).*sin(q(12,:)))./100);
		(cos(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) - sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:)))).*((33.*sin(q(10,:) + q(11,:)))./100 + (3.*sin(q(11,:)))./10 + (73.*cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))))./50 - (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))))./50 + (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:)))./500 + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*((3.*cos(q(14,:)))./50 + 287./1000)) - (cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) + sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:)))).*((33.*cos(q(12,:)))./1000 + (3.*cos(q(11,:)).*sin(q(12,:)))./10 + ((3.*cos(q(14,:)))./50 + 287./1000).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) - (73.*cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))))./500 - (33.*sin(q(10,:)).*sin(q(11,:)).*sin(q(12,:)))./100 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))))./50 + (33.*cos(q(10,:)).*cos(q(11,:)).*sin(q(12,:)))./100) - (cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:)))).*((33.*sin(q(12,:)))./1000 - (3.*cos(q(11,:)).*cos(q(12,:)))./10 + ((3.*cos(q(14,:)))./50 + 287./1000).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - (73.*cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))))./500 + (33.*cos(q(12,:)).*sin(q(10,:)).*sin(q(11,:)))./100 + (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))))./50 - (33.*cos(q(10,:)).*cos(q(11,:)).*cos(q(12,:)))./100 - 31./250);
		(cos(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(14,:)) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:)))).*((33.*sin(q(10,:) + q(11,:)))./100 + (3.*sin(q(11,:)))./10 + (73.*cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))))./50 - (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))))./50 + (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:)))./500 + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*((3.*cos(q(14,:)))./50 + 287./1000)) - (cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))).*((33.*sin(q(12,:)))./1000 - (3.*cos(q(11,:)).*cos(q(12,:)))./10 + ((3.*cos(q(14,:)))./50 + 287./1000).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - (73.*cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))))./500 + (33.*cos(q(12,:)).*sin(q(10,:)).*sin(q(11,:)))./100 + (73.*sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))))./50 - (33.*cos(q(10,:)).*cos(q(11,:)).*cos(q(12,:)))./100 - 31./250) - (cos(q(14,:)).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))).*((33.*cos(q(12,:)))./1000 + (3.*cos(q(11,:)).*sin(q(12,:)))./10 + ((3.*cos(q(14,:)))./50 + 287./1000).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) - (73.*cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))))./500 - (33.*sin(q(10,:)).*sin(q(11,:)).*sin(q(12,:)))./100 - (73.*sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))./500 - (3.*cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))))./50 + (3.*sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))))./50 + (33.*cos(q(10,:)).*cos(q(11,:)).*sin(q(12,:)))./100);
		(cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) - cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) + sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) + cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:)) + cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + 1).^(1./2)./2;
		1./2.*sign(cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) + cos(q(14,:)).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))).*(cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) - sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) + cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) + cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:)) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + 1).^(1./2);
		1./2.*sign(sin(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - cos(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(14,:)) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) + cos(q(13,:)).*cos(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:)))).*(cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) + cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) + sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) - cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:)) - cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) + sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + 1).^(1./2);
		1./2.*sign(sin(q(14,:)).*(cos(q(12,:)).*sin(q(8,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(12,:))) + cos(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) - sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) + cos(q(13,:)).*cos(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:)))).*(cos(q(13,:)).*sin(q(14,:)).*(sin(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*cos(q(12,:))) - cos(q(14,:)).*(sin(q(8,:)).*sin(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*cos(q(12,:))) - sin(q(13,:)).*(sin(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(12,:))) - cos(q(13,:)).*cos(q(14,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)) - sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(8,:))) - cos(q(14,:)).*sin(q(13,:)).*(cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)) + sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(7,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(8,:)).*sin(q(14,:)) - cos(q(13,:)).*(cos(q(7,:)).*(cos(q(8,:)).*cos(q(12,:)) - cos(q(9,:) + q(10,:) + q(11,:)).*sin(q(8,:)).*sin(q(12,:))) + sin(q(9,:) + q(10,:) + q(11,:)).*sin(q(7,:)).*sin(q(12,:))) - sin(q(13,:)).*sin(q(14,:)).*(cos(q(7,:)).*(cos(q(8,:)).*sin(q(12,:)) + cos(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(8,:))) - sin(q(9,:) + q(10,:) + q(11,:)).*cos(q(12,:)).*sin(q(7,:))) + 1).^(1./2)];
end